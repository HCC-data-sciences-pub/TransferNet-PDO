nr: number, eg nr_worker=number of worker
np: nucleus pixel
tp: type pixel
file_ptr: wsi if no proc-mag sepcified
image_ptr: the wsi
chunck: a portion from image_ptr actually predicted each time !!!
patch_input: the np.array generate from a chunk that goes into model, for fast model, the shpae is 256 x 256
patch_output: the output of the model for a input patch, without post-proc
post-proc: process the direct output of the model

output of model : a dict {tp: tp_out,np: np_out, hv: hv_out}
output of infer_step(): probability map generated by F.softmax() 
when set freeze = True, whole encoder [d0,d1,d2,d3]are frozen (no gradient are computed)


### wsi default para: specified in  run_infer.py and run_wsi.sh
    --proc_mag=<n>          Magnification level (objective power) used for WSI processing. [default: 40]
    --ambiguous_size=<int>  Define ambiguous region along tiling grid to perform re-post processing. [default: 128]
    --chunk_shape=<n>       Shape of chunk for processing. [default: 10000]
    --tile_shape=<n>        Shape of tiles for processing. [default: 2048]
    
    if args['model_mode'] == 'fast':
        run_args['patch_input_shape'] = 256     # shape of model input
        run_args['patch_output_shape'] = 164    # shape of model output
        
    date flow:
    wsi > chunk (10000,10000) > patch_input (256,256) > model > patch_output (164,164)   

### the return of __get_raw_prediction probabilities of F.softmax() ###
wsi.InferManager.__get_raw_prediction %call% 
                                     __run_model() %call% 
                                    self.run_step() == run_desc.infer_step() %call% 
                                    1 . model()
                                    2 . F.softmax()on model output


wsi.InferManager.__dispatch_post_processing %call% 
                    1. post_proc.process()on output of __get_raw_prediction to prepare inst_info_dict fo json file
                    2. 3 callbacks to fixed nuclei at borders



### Modify hoverent code for training:
1. change augmentation parameters in __get_augmentation() from /dataloader/train_loader.py
2. add code to output probabilities of all cell types in process() from /models/hovernet/post_procss.py
3. modify code to save a initialized model (has not load state_dict yet !!) in create_model() from /models/hovernet/net_desc.py  
4. modify code to save a model after load_state_diction in __load_model() from /infer/base.py
5.change scaling of generated mask for prediction (default 1.25 to 5 for PDO wsi prediction) in infer/wsi.py line 510 


bulit-in function in python:
__call__(func): call func when create an instance of the class enclose this __call__() 




